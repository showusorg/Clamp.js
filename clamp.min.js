(function(){function e(e,t){function c(e,t){if(!r.getComputedStyle){r.getComputedStyle=function(e,t){this.el=e;this.getPropertyValue=function(t){var n=/(\-([a-z]){1})/g;if(t=="float")t="styleFloat";if(n.test(t)){t=t.replace(n,function(){return arguments[2].toUpperCase()})}return e.currentStyle&&e.currentStyle[t]?e.currentStyle[t]:null};return this}}return r.getComputedStyle(e,null).getPropertyValue(t)}function h(t){var n=t||e.clientHeight,r=d(e);return Math.max(Math.floor(n/r),0)}function p(t){var n=d(e);return n*t}function d(e){var t=c(e,"line-height");if(t=="normal"){t=parseInt(c(e,"font-size"))*1.2}return parseInt(t)}function b(t){if(t.lastChild.children&&t.lastChild.children.length>0){return b(Array.prototype.slice.call(t.children).pop())}else if(!t.lastChild||!t.lastChild.nodeValue||t.lastChild.nodeValue==""||t.lastChild.nodeValue==i.truncationChar){t.lastChild.parentNode.removeChild(t.lastChild);return b(e)}else{return t.lastChild}}function w(t,n){function r(){v=i.splitOnChars.slice(0);m=v[0];g=null;y=null}if(!n){return}var s=t.nodeValue.replace(i.truncationChar,"");if(!g){if(v.length>0){m=v.shift()}else{m=""}g=s.split(m)}if(g.length>1){y=g.pop();E(t,g.join(m))}else{g=null}if(l){t.nodeValue=t.nodeValue.replace(i.truncationChar,"");var o=document.createTextNode(t.nodeValue);$(e).empty();e.appendChild(o);e.appendChild($(l.innerHTML)[0])}if(g){if(e.clientHeight<=n){if(v.length>=0&&m!=""){E(t,g.join(m)+m+y);g=null}else{return e.innerHTML}}}else{if(m==""){E(t,"");t=b(e);r()}}if(i.animate){setTimeout(function(){w(t,n)},i.animate===true?10:i.animate)}else{return w(t,n)}}function E(e,t){e.nodeValue=t+i.truncationChar}t=t||{};var n=this,r=window,i={clamp:t.clamp||2,useNativeClamp:typeof t.useNativeClamp!="undefined"?t.useNativeClamp:true,splitOnChars:t.splitOnChars||[".","-","-","--"," "],animate:t.animate||false,truncationChar:t.truncationChar||"...",truncationHTML:t.truncationHTML},s=e.style,o=e.innerHTML,u=typeof e.style.webkitLineClamp!="undefined",a=i.clamp,f=a.indexOf&&(a.indexOf("px")>-1||a.indexOf("em")>-1),l;if(i.truncationHTML){l=document.createElement("span");l.innerHTML=i.truncationHTML}var v=i.splitOnChars.slice(0),m=v[0],g,y;if(a=="auto"){a=h()}else if(f){a=h(parseInt(a))}var S;if(u&&i.useNativeClamp){s.overflow="hidden";s.textOverflow="ellipsis";s.webkitBoxOrient="vertical";s.display="-webkit-box";s.webkitLineClamp=a;if(f){s.height=i.clamp+"px"}}else{var x=p(a);if(x<=e.clientHeight){S=w(b(e),x)}}return{original:o,clamped:S}}window.$clamp=e})()
